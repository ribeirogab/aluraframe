{"version":3,"sources":["../../../src/domain/negotiation/NegotiationDao.js"],"names":["Negotiation","NegotiationDao","constructor","connection","_connection","_store","add","negotiation","Promise","resolve","reject","request","transaction","objectStore","onsuccess","e","onerror","console","log","target","error","name","deleteAll","clear","listAll","negotiations","openCursor","current","result","push","value","_date","_amount","_value","continue"],"mappings":";;;;;;AAASA,iB,kBAAAA,W;;;AAEF,YAAMC,cAAN,CAAoB;AACzBC,oBAAYC,UAAZ,EAAuB;AACrB,eAAKC,WAAL,GAAmBD,UAAnB;AACA,eAAKE,MAAL,GAAc,cAAd;AACD;;AAEDC,YAAIC,WAAJ,EAAgB;AACd,iBAAO,IAAIC,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,kBAAMC,UAAU,KAAKP,WAAL,CACbQ,WADa,CACD,CAAC,KAAKP,MAAN,CADC,EACc,WADd,EAEbQ,WAFa,CAED,KAAKR,MAFJ,EAGbC,GAHa,CAGTC,WAHS,CAAhB;;AAKAI,oBAAQG,SAAR,GAAoBC,KAAKN,SAAzB;;AAEAE,oBAAQK,OAAR,GAAkBD,KAAK;AACrBE,sBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAV,qBAAOK,EAAEI,MAAF,CAASC,KAAT,CAAeC,IAAtB;AACD,aAHD;AAID,WAZM,CAAP;AAaD;;AAEDC,oBAAY;AACV,iBAAO,IAAId,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,kBAAMC,UAAU,KAAKP,WAAL,CACbQ,WADa,CACD,CAAC,KAAKP,MAAN,CADC,EACc,WADd,EAEbQ,WAFa,CAED,KAAKR,MAFJ,EAGbkB,KAHa,EAAhB;;AAKAZ,oBAAQG,SAAR,GAAoBC,KAAKN,QAAQ,uBAAR,CAAzB;;AAEAE,oBAAQK,OAAR,GAAkBD,KAAK;AACrBE,sBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAV,qBAAO,mBAAP;AACD,aAHD;AAID,WAZM,CAAP;AAaD;;AAEDc,kBAAS;AACP,iBAAO,IAAIhB,OAAJ,CAAY,CAACC,OAAD,EAAUC,MAAV,KAAqB;AACtC,kBAAMe,eAAe,EAArB;AACA,kBAAMd,UAAU,KAAKP,WAAL,CACbQ,WADa,CACD,CAAC,KAAKP,MAAN,CADC,EACc,WADd,EAEbQ,WAFa,CAED,KAAKR,MAFJ,EAGbqB,UAHa,EAAhB;;AAKAf,oBAAQG,SAAR,GAAoBC,KAAK;AACvB,oBAAMY,UAAUZ,EAAEI,MAAF,CAASS,MAAzB;AACA,kBAAGD,OAAH,EAAW;AACTF,6BAAaI,IAAb,CACE,IAAI7B,WAAJ,CACE2B,QAAQG,KAAR,CAAcC,KADhB,EAEEJ,QAAQG,KAAR,CAAcE,OAFhB,EAGEL,QAAQG,KAAR,CAAcG,MAHhB,CADF;AAOAN,wBAAQO,QAAR;AACD,eATD,MASO;AACLzB,wBAAQgB,YAAR;AACD;AACF,aAdD;;AAgBAd,oBAAQK,OAAR,GAAkBD,KAAK;AACrBE,sBAAQC,GAAR,CAAYH,EAAEI,MAAF,CAASC,KAArB;AACAV,qBAAOK,EAAEI,MAAF,CAASC,KAAT,CAAeC,IAAtB;AACD,aAHD;AAID,WA3BM,CAAP;AA4BD;AAnEwB","file":"NegotiationDao.js","sourcesContent":["import { Negotiation } from \"./Negotiation.js\";\n\nexport class NegotiationDao{\n  constructor(connection){\n    this._connection = connection\n    this._store = 'negotiations'\n  }\n\n  add(negotiation){\n    return new Promise((resolve, reject) => {\n      const request = this._connection\n        .transaction([this._store], 'readwrite')\n        .objectStore(this._store)\n        .add(negotiation)\n\n      request.onsuccess = e => resolve()\n\n      request.onerror = e => {\n        console.log(e.target.error)\n        reject(e.target.error.name)\n      }\n    })\n  }\n\n  deleteAll() {\n    return new Promise((resolve, reject) => {\n      const request = this._connection\n        .transaction([this._store], 'readwrite')\n        .objectStore(this._store)\n        .clear()\n\n      request.onsuccess = e => resolve('Successfully deleted!')\n\n      request.onerror = e => {\n        console.log(e.target.error)\n        reject('Couldn\\'t delete!')\n      }\n    })\n  }\n\n  listAll(){\n    return new Promise((resolve, reject) => {\n      const negotiations = []\n      const request = this._connection\n        .transaction([this._store], 'readwrite')\n        .objectStore(this._store)\n        .openCursor()\n\n      request.onsuccess = e => {\n        const current = e.target.result\n        if(current){\n          negotiations.push(\n            new Negotiation(\n              current.value._date,\n              current.value._amount,\n              current.value._value,\n            )\n          )\n          current.continue()\n        } else {\n          resolve(negotiations)\n        }\n      }\n\n      request.onerror = e => {\n        console.log(e.target.error)\n        reject(e.target.error.name)\n      }\n    })\n  }\n}"]}